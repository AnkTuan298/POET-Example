@using POETWeb.Models
@inject SignInManager<ApplicationUser> SignInManager

@{
    var hasExternalLogins = (await SignInManager.GetExternalAuthenticationSchemesAsync()).Any();

    // Helper: trả về "active" + aria-current chuẩn cho link đang chọn
    string Active(string cls) => string.IsNullOrEmpty(cls) ? "" : "active";
    var indexCls = ManageNavPages.IndexNavClass(ViewContext);
    var emailCls = ManageNavPages.EmailNavClass(ViewContext);
    var passCls = ManageNavPages.ChangePasswordNavClass(ViewContext);
    var extCls = hasExternalLogins ? ManageNavPages.ExternalLoginsNavClass(ViewContext) : "";
    var pdCls = ManageNavPages.PersonalDataNavClass(ViewContext);
}

<nav class="manage-sidenav" aria-label="Account settings">
    <div class="manage-sidenav__title">Account</div>
    <ul class="manage-sidenav__list">
        <li>
            <a class="manage-link @Active(indexCls)"
               asp-page="./Index"
               aria-current="@(indexCls?.Contains("active") == true ? "page" : null)">
                <i class="bi bi-person-badge"></i>
                <span>Profile</span>
            </a>
        </li>

        <li>
            <a class="manage-link @Active(emailCls)"
               asp-page="./Email"
               aria-current="@(emailCls?.Contains("active") == true ? "page" : null)">
                <i class="bi bi-envelope"></i>
                <span>Email</span>
            </a>
        </li>

        <li>
            <a class="manage-link @Active(passCls)"
               asp-page="./ChangePassword"
               aria-current="@(passCls?.Contains("active") == true ? "page" : null)">
                <i class="bi bi-shield-lock"></i>
                <span>Password</span>
            </a>
        </li>

        @if (hasExternalLogins)
        {
            <li>
                <a class="manage-link @Active(extCls)"
                   asp-page="./ExternalLogins"
                   aria-current="@(extCls?.Contains("active") == true ? "page" : null)">
                    <i class="bi bi-box-arrow-in-right"></i>
                    <span>External logins</span>
                </a>
            </li>
        }

        <li class="manage-divider" role="separator" aria-hidden="true"></li>

        <li>
            <a class="manage-link @Active(pdCls)"
               asp-page="./PersonalData"
               aria-current="@(pdCls?.Contains("active") == true ? "page" : null)">
                <i class="bi bi-person-lines-fill"></i>
                <span>Personal data</span>
            </a>
        </li>
    </ul>
</nav>

<style>
    /* Shell */
    .manage-sidenav {
        background: #fff;
        border: 1px solid #eef2f7;
        border-radius: 16px;
        padding: 12px;
        box-shadow: 0 4px 14px rgba(24,39,75,.06);
        position: sticky;
        top: 16px;
    }

    .manage-sidenav__title {
        font-weight: 800;
        font-size: .9rem;
        color: #334155;
        letter-spacing: .3px;
        padding: 8px 10px 6px;
        opacity: .9
    }

    .manage-sidenav__list {
        list-style: none;
        margin: 0;
        padding: 6px;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .manage-link {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: 999px;
        text-decoration: none;
        color: #0f172a;
        border: 1px solid transparent;
        transition: background .12s ease, box-shadow .12s ease, border-color .12s ease;
    }

        .manage-link i {
            font-size: 1rem;
            color: #475569
        }

        .manage-link:hover {
            background: #f8fafc;
            border-color: #e5e7eb;
        }

        .manage-link.active {
            background: linear-gradient(90deg,#eef2ff,#e0f2fe);
            border-color: #dbeafe;
            box-shadow: 0 6px 16px rgba(99,102,241,.12);
        }

            .manage-link.active i {
                color: #4f46e5
            }

    .manage-divider {
        height: 1px;
        background: #eef2f7;
        margin: 8px 10px;
        border-radius: 999px;
    }

    @@media (max-width: 991px) {
        .manage-sidenav

    {
        position: static;
    }

    }
</style>
